  <page>
    <title>Advanced Power Management</title>
    <ns>0</ns>
    <id>3130</id>
    <revision>
      <id>935102973</id>
      <parentid>718741565</parentid>
      <timestamp>2020-01-10T14:02:48Z</timestamp>
      <contributor>
        <username>Artoria2e5</username>
        <id>18040497</id>
      </contributor>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text xml:space="preserve">{{more footnotes|date=May 2016}}
'''Advanced power management''' ('''APM''') is an [[Application programming interface|API]] developed by [[Intel]] and [[Microsoft]] and released in 1992&lt;ref name=&quot;APM_spec_V12&quot; /&gt; which enables an [[operating system]] running an IBM-compatible [[personal computer]] to work with the [[BIOS]] (part of the computer's [[firmware]]) to achieve [[power management]].

Revision 1.2 was the last version of the APM specification, released in 1996. [[Advanced Configuration and Power Interface|ACPI]] is intended as the successor to APM. Microsoft dropped support for APM in [[Windows Vista]]. The [[Linux|Linux kernel]] still mostly supports APM, with the last fully functional APM support shipping in 3.3.

==Overview==
[[File:APM-Layers.svg|thumb|The layers in APM]]
APM uses a layered approach to manage devices. APM-aware applications (which include device drivers) talk to an OS-specific APM driver. This driver communicates to the APM-aware BIOS, which controls the hardware. There is the ability to opt out of APM control on a device-by-device basis, which can be used if a driver wants to communicate directly with a hardware device.

Communication occurs both ways; power management events are sent from the BIOS to the APM driver, and the APM driver sends information and requests to the BIOS via function calls. In this way the APM driver is an intermediary between the BIOS and the operating system.

Power management happens in two ways; through the above-mentioned function calls from the APM driver to the BIOS requesting power state changes, and automatically based on device activity.

== Power management events ==
There are 12 power events (such as standby, suspend and resume requests, and low battery notifications), plus [[Original equipment manufacturer|OEM]]-defined events, that can be sent from the APM BIOS to the operating system. The APM driver regularly [[Polling (computer science)|polls]] for event change notifications.

Power Management Events:&lt;ref name=&quot;APM_spec_V12&quot;&gt;{{cite web|title=Advanced Power Management (APM) BIOS Interface Specification Revision 1.2 February 1996 Intel/Microsoft|url= http://download.microsoft.com/download/1/6/1/161ba512-40e2-4cc9-843a-923143f3456c/APMV12.rtf}} 090429&lt;/ref&gt;
{| class=&quot;wikitable&quot;
|- 
! Name !! Code !! Comment
|-
| System Standby Request Notification  || 0x0001 ||
|-
| System Suspend Request Notification  || 0x0002 ||
|-
| Normal Resume System Notification  || 0x0003 ||
|-
| Critical Resume System Notification  || 0x0004 ||
|-
| Battery Low Notification  || 0x0005 ||
|-
| Power Status Change Notification  || 0x0006 ||
|-
| Update Time Notification  || 0x0007 ||
|-
| Critical System Suspend Notification  || 0x0008 ||
|-
| User System Standby Request Notification  || 0x0009 ||
|-
| User System Suspend Request Notification  || 0x000A ||
|-
| System Standby Resume Notification  || 0x000B ||
|-
| Capabilities Change Notification  || 0x000C || Due to setup or device insertion/removal
|}

Power management functions:&lt;ref name=&quot;APM_spec_V12&quot; /&gt;
{| class=&quot;wikitable&quot;
|- 
! Name !! Code !! Comment
|-
| APM Installation Check  || 0x00 ||
|-
| APM Real Mode Interface Connect  || 0x01 ||
|-
| APM Protected Mode 16-bit Interface Connect  || 0x02 || Avoids real or virtual86 mode.
|-
| APM Protected Mode 32-bit Interface Connect  || 0x03 || Avoids real or virtual86 mode.
|-
| APM Interface Disconnect  || 0x04 ||
|-
| CPU Idle  || 0x05 || Requests system suspend.&lt;!--P42--&gt; &lt;BR&gt;0) Clock halted until timer tick interrupt.&lt;BR&gt; 1) Slow clock&lt;!--P29--&gt;&lt;ref name=&quot;APM_spec_V12&quot; /&gt;
|-
| CPU Busy  || 0x06 || Driver tells system APM to restore clock speed of the CPU.
|-
| '''Set Power State'''  || 0x07 || Set system or device into Suspend/Standby/Off state.&lt;!--P44--&gt;
|-
| Enable/Disable Power Management  || 0x08 ||
|-
| Restore APM BIOS Power-On Defaults  || 0x09 ||
|-
| Get Power Status  || 0x0A || Supports AC status &quot;On backup power&quot;. And battery status.
|-
| Get PM Event  || 0x0B || Checks for APM events. Shall be called once per second.
|-
| Get Power State  || 0x0C ||
|-
| Enable/Disable Device Power Management  || 0x0D ||
|-
| APM Driver Version  || 0x0E ||
|-
| Engage/Disengage Power Management  || 0x0F || APM management for a specific device.
|-
| Get Capabilities  || 0x10 ||
|-
| Get/Set/Disable Resume Timer  || 0x11 ||
|-
| Enable/Disable Resume on Ring Indicator  || 0x12 ||
|-
| Enable/Disable Timer Based Requests  || 0x13 ||
|-
| OEM APM Installation Check  || 0x80 || Tells if APM BIOS supports OEM hardware dependent functions.
|-
| OEM APM Function  || 0x80 || Access to OEM specific functions.
|}

==APM functions==
There are 21 APM function calls defined that the APM driver can use to query power management statuses, or request power state transitions. Example function calls include letting the BIOS know about current CPU usage (the BIOS may respond to such a call by placing the CPU in a low-power state, or returning it to its full-power state), retrieving the current power state of a device, or requesting a power state change.

==Power states==
The APM specification defines system power states and device power states.

===System power states===
APM defines five power states for the computer system:
* Full On: The computer is powered on, and no devices are in a power saving mode.
* APM Enabled: The computer is powered on, and APM is controlling device power management as needed.
* APM Standby: Most devices are in their low-power state, the CPU is slowed or stopped, and the system state is saved. The computer can be returned to its former state quickly (in response to activity such as the user pressing a key on the keyboard).
* APM Suspend: Most devices are powered off, but the system state is saved. The computer can be returned to its former state, but takes a relatively long time. (Hibernation is a special form of the APM Suspend state).
* Off: The computer is turned off.

===Device power states===
APM also defines power states that APM-aware hardware can implement. There is no requirement that an APM-aware device implement all states.

The four states are:
* Device On: The device is in full power mode.
* Device Power Managed: The device is still powered on, but some functions may not be available, or may have reduced performance.
* Device Low Power: The device is not working. Power is maintained so that the device may be 'woken up'.
* Device Off: The device is powered off.

==CPU==
The CPU core (defined in APM as the CPU clock, [[CPU cache|cache]], [[Front side bus|system bus]] and system timers) is treated specially in APM, as it is the last device to be powered down, and the first device to be powered back up. The CPU core is always controlled through the APM BIOS (there is no option to control it through a driver). Drivers can use APM function calls to notify the BIOS about CPU usage, but it is up to the BIOS to act on this information; a driver cannot directly tell the CPU to go into a power saving state.

==In ATA drives==
The [[Parallel ATA|ATA]] specification defines APM provisions for hard drives via the subcommand {{tt|0x05}}, which specifies a trade-off between spin-down frequency and always-on performance. Unlike the BIOS-side APM, the ATA APM has never been deprecated.&lt;ref&gt;{{cite web |title=linux - What do different values of hard drive's Advanced Power Management feature (hdparm -B) affect, except spin-down? |url=https://superuser.com/a/558622 |website=Super User |quote=The ATA Spec turns up this tidbit:  Subcommand code 05h allows the host to enable Advanced Power Management. To enable Advanced Power Management, the host writes the Sector Count register with the desired advanced power management level and then executes a SET FEATURES command with subcommand code 05h.}}&lt;/ref&gt;

== See also ==
* [[Active State Power Management]] - hardware power management protocol for [[PCI Express]]
* [[Advanced Configuration and Power Interface]] (ACPI) - successor to APM
* [[Green computing]]
* [[Power management]]
* [[BatteryMAX (idle detection)]]

== References ==
{{reflist}}

== External links ==
*APM V1.2 [http://download.microsoft.com/download/1/6/1/161ba512-40e2-4cc9-843a-923143f3456c/APMV12.rtf Specification] ([[Rich Text Format|RTF]] file).
*{{FOLDOC}}

{{Computer processor power management technologies}}
{{CPU technologies}}

{{DEFAULTSORT:Advanced Power Management}}
[[Category:BIOS]]</text>
      <sha1>1dzqsd674w6ybhhsxn1pi6k9texwbi8</sha1>
    </revision>
  </page>
